---
import Base from "../../layouts/Base.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<Base title="Blog â€” The Lab" description="Insights on AI, local empowerment, and the tools we build.">
  <section class="max-w-4xl mx-auto px-6 py-20">
    <h1 class="text-4xl font-bold mb-4">Blog</h1>
    <p class="text-gray-400 mb-12">
      Thoughts on AI, tools we're building, and stories from the field.
    </p>

    {posts.length === 0 ? (
      <p class="text-muted">No posts yet. Check back soon.</p>
    ) : (
      <div class="space-y-8">
        {posts.map((post) => (
          <a href={`/blog/${post.slug}`} class="block bg-surface border border-white/5 rounded-xl p-6 hover:border-accent/30 transition group">
            <div class="flex items-center gap-3 mb-2">
              <span class="text-sm text-muted">{post.data.date}</span>
              {post.data.tags?.map((tag) => (
                <span class="text-xs bg-accent/10 text-accent px-2 py-0.5 rounded-full">{tag}</span>
              ))}
            </div>
            <h2 class="text-xl font-semibold mb-2 group-hover:text-accent transition">{post.data.title}</h2>
            <p class="text-gray-400">{post.data.excerpt}</p>
          </a>
        ))}
      </div>
    )}
  </section>
</Base>
